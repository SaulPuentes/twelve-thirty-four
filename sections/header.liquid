<style>
  :root {
    --header-padding: {{ section.settings.padding }}px;
    --header-height: calc({{ section.settings.padding }}px * 2 + 40px);
  }
</style>

<header
  id="header"
  class="header{% if section.settings.enable_sticky %} header--sticky{% endif %}{% if section.settings.enable_transparent and template.name == 'index' %} header--transparent{% endif %}"
  data-header
  style="
    --header-padding: {{ section.settings.padding }}px;
  "
>
  <div class="header__inner page-width">
    {%- comment -%} Logo {%- endcomment -%}
    <div class="header__logo">
      <a href="{{ routes.root_url }}" class="header__logo-link" aria-label="{{ shop.name }}">
        <img
          src="{{ 'header-logo.png' | asset_url }}"
          alt="{{ shop.name }}"
          class="header__logo-image header__logo-image--default"
          width="180"
          height="auto"
          loading="eager"
        >
        {%- comment -%} Inverse logo for transparent header with light backgrounds {%- endcomment -%}
        <img
          src="{{ 'header-logo.png' | asset_url }}"
          alt="{{ shop.name }}"
          class="header__logo-image header__logo-image--inverse"
          width="180"
          height="auto"
          loading="eager"
        >
      </a>
    </div>

    {%- comment -%} Navigation {%- endcomment -%}
    <nav class="header__nav hidden md:flex" aria-label="{{ 'accessibility.main_navigation' | t }}">
      <ul class="header__nav-list">
        {%- for link in section.settings.menu.links -%}
          <li class="header__nav-item{% if link.links.size > 0 %} header__nav-item--has-dropdown{% endif %}">
            <a
              href="{{ link.url }}"
              class="header__nav-link{% if link.active %} header__nav-link--active{% endif %}"
              {% if link.links.size > 0 %}
                aria-haspopup="true"
                aria-expanded="false"
              {% endif %}
            >
              {{ link.title }}
            </a>
            {%- if link.links.size > 0 -%}
              <div class="header__dropdown">
                <ul class="header__dropdown-list">
                  {%- for child_link in link.links -%}
                    <li class="header__dropdown-item">
                      <a href="{{ child_link.url }}" class="header__dropdown-link">
                        {{ child_link.title }}
                      </a>
                    </li>
                  {%- endfor -%}
                </ul>
              </div>
            {%- endif -%}
          </li>
        {%- endfor -%}
      </ul>
    </nav>

    {%- comment -%} Actions & Mobile Menu {%- endcomment -%}
    <div class="header__actions-wrapper">
      {% render 'header-actions' %}

      {%- comment -%} Mobile menu button {%- endcomment -%}
      <button
        type="button"
        class="header__menu-toggle md:hidden"
        aria-label="{{ 'accessibility.open_menu' | t }}"
        data-menu-toggle
      >
        {% render 'icon', icon: 'menu', size: 24 %}
      </button>
    </div>
  </div>
</header>

{%- comment -%} Mobile Menu Drawer {%- endcomment -%}
<div class="mobile-menu" id="mobile-menu" aria-hidden="true" data-mobile-menu>
  <div class="mobile-menu__overlay" data-menu-close></div>
  <div class="mobile-menu__content">
    <div class="mobile-menu__header">
      <button type="button" class="mobile-menu__close" data-menu-close aria-label="{{ 'accessibility.close' | t }}">
        {% render 'icon', icon: 'close', size: 24 %}
      </button>
    </div>
    <nav class="mobile-menu__nav" aria-label="{{ 'accessibility.main_navigation' | t }}">
      <ul class="mobile-menu__list">
        {%- for link in section.settings.menu.links -%}
          <li class="mobile-menu__item">
            <a href="{{ link.url }}" class="mobile-menu__link">
              {{ link.title }}
            </a>
          </li>
        {%- endfor -%}
      </ul>
    </nav>

    {%- comment -%} Social Media Links {%- endcomment -%}
    <div class="mobile-menu__social">
      {% render 'social-media', class: 'mobile-menu__social', link_class: 'mobile-menu__social-link', icon_size: 20 %}
    </div>

    <div class="mobile-menu__footer">
      {%- if shop.customer_accounts_enabled -%}
        <a href="{{ routes.account_url }}" class="mobile-menu__footer-link">
          {% render 'icon', icon: 'account', size: 20 %}
          <span>{{ 'customer.account.title' | t }}</span>
        </a>
      {%- endif -%}
      {%- if section.settings.show_search -%}
        <a href="{{ routes.search_url }}" class="mobile-menu__footer-link">
          {% render 'icon', icon: 'search', size: 20 %}
          <span>{{ 'general.search.title' | t }}</span>
        </a>
      {%- endif -%}
    </div>
  </div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    const header = document.querySelector('[data-header]');
    const menuToggle = document.querySelector('[data-menu-toggle]');
    const mobileMenu = document.querySelector('[data-mobile-menu]');
    const menuClose = document.querySelectorAll('[data-menu-close]');

    // Sticky header scroll behavior
    if (header.classList.contains('header--sticky')) {
      let lastScroll = 0;
      
      window.addEventListener('scroll', function() {
        const currentScroll = window.pageYOffset;
        
        if (currentScroll > 100) {
          header.classList.add('header--scrolled');
        } else {
          header.classList.remove('header--scrolled');
        }
        
        lastScroll = currentScroll;
      });
    }

    // Mobile menu toggle
    if (menuToggle && mobileMenu) {
      menuToggle.addEventListener('click', function() {
        mobileMenu.setAttribute('aria-hidden', 'false');
        document.body.classList.add('overflow-hidden');
      });

      menuClose.forEach(function(button) {
        button.addEventListener('click', function() {
          mobileMenu.setAttribute('aria-hidden', 'true');
          document.body.classList.remove('overflow-hidden');
        });
      });
    }

  });
</script>

{% stylesheet %}
  /* Add top padding to main content on all pages except index */
  body:not(.template-index) .main-content {
    padding-top: var(--header-height);
  }

  .header {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    z-index: 100;
    padding: var(--header-padding, 1.5rem) var(--page-margin);
    transition: background-color var(--animation-speed) var(--animation-easing),
                transform var(--animation-speed) var(--animation-easing);
  }

  .header--sticky.header--scrolled {
    background-color: var(--color-background, #fff);
    box-shadow: 0 1px 0 var(--color-border, #ddd);
  }

  .header--transparent:not(.header--scrolled) {
    background-color: transparent;
  }

  .header--transparent:not(.header--scrolled) .header__nav-link,
  .header--transparent:not(.header--scrolled) .header__action,
  .header--transparent:not(.header--scrolled) .header__menu-toggle,
  .header--transparent:not(.header--scrolled) .header__logo-text {
    color: #fff;
    transition: color 0.6s ease-in-out;
  }

  /* Header text color based on hero slide */
  body[data-hero-text-color="black"] .header--transparent:not(.header--scrolled) .header__nav-link,
  body[data-hero-text-color="black"] .header--transparent:not(.header--scrolled) .header__action,
  body[data-hero-text-color="black"] .header--transparent:not(.header--scrolled) .header__menu-toggle,
  body[data-hero-text-color="black"] .header--transparent:not(.header--scrolled) .header__logo-text {
    color: #000;
  }

  body[data-hero-text-color="white"] .header--transparent:not(.header--scrolled) .header__logo-image {
    filter: invert(1);
  }

  .header--transparent:not(.header--scrolled) .header__logo-image--default {
    display: none;
  }

  .header--transparent:not(.header--scrolled) .header__logo-image--inverse {
    display: block;
  }

  .header__logo-image--inverse {
    display: none;
  }

  /* Show default logo when hero has black text */
  body[data-hero-text-color="black"] .header--transparent:not(.header--scrolled) .header__logo-image--default {
    display: block;
  }

  body[data-hero-text-color="black"] .header--transparent:not(.header--scrolled) .header__logo-image--inverse {
    display: none;
  }

  .header__inner {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 2rem;
  }

  .header__logo {
    flex-shrink: 0;
  }

  .header__logo-link {
    display: flex;
    align-items: center;
    text-decoration: none;
    color: inherit;
  }

  .header__logo-text {
    font-family: var(--font-body-family);
    font-size: 0.75rem;
    font-weight: 500;
    letter-spacing: 0.15em;
    text-transform: uppercase;
    transition: color var(--animation-speed) var(--animation-easing);
  }

  .header__logo-image {
    height: auto;
    max-height: 40px;
    width: auto;
  }

  .header__nav {
    flex: 1;
    justify-content: flex-end;
  }

  .header__nav-list {
    display: flex;
    align-items: center;
    gap: 1.5rem;
    list-style: none;
    margin: 0;
    padding: 0;
  }

  .header__nav-link {
    font-family: var(--font-body-family);
    font-size: 0.8rem;
    font-weight: 400;
    letter-spacing: 0.1em;
    text-transform: uppercase;
    text-decoration: none;
    color: var(--color-foreground);
    transition: opacity var(--animation-speed) var(--animation-easing),
                color var(--animation-speed) var(--animation-easing);
  }

  .header__nav-link:hover {
    opacity: 0.7;
  }

  .header__nav-item--has-dropdown {
    position: relative;
  }

  .header__dropdown {
    position: absolute;
    top: 100%;
    left: 0;
    min-width: 200px;
    padding-top: 1rem;
    opacity: 0;
    visibility: hidden;
    transform: translateY(-10px);
    transition: opacity var(--animation-speed) var(--animation-easing),
                visibility var(--animation-speed) var(--animation-easing),
                transform var(--animation-speed) var(--animation-easing);
  }

  .header__nav-item--has-dropdown:hover .header__dropdown {
    opacity: 1;
    visibility: visible;
    transform: translateY(0);
  }

  .header__dropdown-list {
    background-color: var(--color-background, #fff);
    border: 1px solid var(--color-border, #ddd);
    list-style: none;
    margin: 0;
    padding: 1rem;
  }

  .header__dropdown-link {
    display: block;
    padding: 0.5rem 0;
    font-family: var(--font-body-family);
    font-size: 0.875rem;
    text-decoration: none;
    color: var(--color-foreground);
    transition: opacity var(--animation-speed) var(--animation-easing);
  }

  .header__dropdown-link:hover {
    opacity: 0.7;
  }

  .header__actions-wrapper {
    display: flex;
    align-items: center;
    gap: 1rem;
  }

  .header__actions {
    display: flex;
    align-items: center;
    gap: 1rem;
  }

  .header__action {
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--color-foreground);
    transition: opacity var(--animation-speed) var(--animation-easing),
                color var(--animation-speed) var(--animation-easing);
  }

  .header__action:hover {
    opacity: 0.7;
  }

  /* Cart icon styles are now handled by header-actions snippet */

  .header__menu-toggle {
    display: flex;
    align-items: center;
    justify-content: center;
    background: none;
    border: none;
    padding: 0;
    cursor: pointer;
    color: var(--color-foreground);
    transition: opacity var(--animation-speed) var(--animation-easing),
                color var(--animation-speed) var(--animation-easing);
  }

  .header__menu-toggle:hover {
    opacity: 0.7;
  }

  /* Mobile Menu */
  .mobile-menu {
    position: fixed;
    inset: 0;
    z-index: 200;
    opacity: 0;
    visibility: hidden;
    transition: opacity 0.4s var(--animation-easing),
                visibility 0.4s var(--animation-easing);
  }

  .mobile-menu[aria-hidden="false"] {
    opacity: 1;
    visibility: visible;
  }

  .mobile-menu__overlay {
    position: absolute;
    inset: 0;
    background-color: rgba(0, 0, 0, 0.8);
  }

  .mobile-menu__content {
    position: absolute;
    inset: 0;
    width: 100%;
    background-color: var(--color-background, #fff);
    display: flex;
    flex-direction: column;
  }

  .mobile-menu__header {
    display: flex;
    justify-content: flex-end;
    padding: 1.5rem;
    position: absolute;
    top: 0;
    right: 0;
    z-index: 10;
  }

  .mobile-menu__close {
    background: none;
    border: none;
    padding: 0;
    cursor: pointer;
    color: var(--color-foreground);
    transition: opacity 0.3s ease;
  }

  .mobile-menu__close:hover {
    opacity: 0.7;
  }

  .mobile-menu__nav {
    flex: 1;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 4rem 2rem 2rem;
  }

  .mobile-menu__list {
    list-style: none;
    margin: 0;
    padding: 0;
    text-align: center;
    width: 100%;
  }

  .mobile-menu__item {
    opacity: 0;
    transform: translateX(-40px);
  }

  /* Alternate animation direction based on index */
  .mobile-menu__item:nth-child(even) {
    transform: translateX(40px);
  }

  .mobile-menu[aria-hidden="false"] .mobile-menu__item {
    opacity: 1;
    transform: translateX(0);
    transition: opacity 0.6s ease, transform 0.6s cubic-bezier(0.16, 1, 0.3, 1);
  }

  /* Stagger the animations */
  .mobile-menu[aria-hidden="false"] .mobile-menu__item:nth-child(1) {
    transition-delay: 0.1s;
  }

  .mobile-menu[aria-hidden="false"] .mobile-menu__item:nth-child(2) {
    transition-delay: 0.15s;
  }

  .mobile-menu[aria-hidden="false"] .mobile-menu__item:nth-child(3) {
    transition-delay: 0.2s;
  }

  .mobile-menu[aria-hidden="false"] .mobile-menu__item:nth-child(4) {
    transition-delay: 0.25s;
  }

  .mobile-menu[aria-hidden="false"] .mobile-menu__item:nth-child(5) {
    transition-delay: 0.3s;
  }

  .mobile-menu[aria-hidden="false"] .mobile-menu__item:nth-child(6) {
    transition-delay: 0.35s;
  }

  .mobile-menu[aria-hidden="false"] .mobile-menu__item:nth-child(7) {
    transition-delay: 0.4s;
  }

  .mobile-menu[aria-hidden="false"] .mobile-menu__item:nth-child(8) {
    transition-delay: 0.45s;
  }

  .mobile-menu__link {
    display: inline-block;
    padding: 1.25rem 0;
    font-family: var(--font-heading-family);
    font-size: clamp(2rem, 5vw, 3rem);
    font-weight: 400;
    text-decoration: none;
    color: var(--color-foreground);
    transition: opacity 0.3s ease;
  }

  .mobile-menu__link:hover {
    opacity: 0.6;
  }

  .mobile-menu__footer {
    padding: 2rem;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 1.5rem;
    border-top: 1px solid var(--color-border, #ddd);
  }

  .mobile-menu__footer-link {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-size: 0.875rem;
    text-decoration: none;
    color: var(--color-foreground);
    transition: opacity 0.3s ease;
  }

  .mobile-menu__footer-link:hover {
    opacity: 0.6;
  }

  .mobile-menu__social {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 1.5rem;
    padding: 2rem;
  }

  .mobile-menu__social-link {
    display: flex;
    align-items: center;
    color: var(--color-foreground);
    transition: opacity 0.3s ease;
  }

  .mobile-menu__social-link:hover {
    opacity: 0.6;
  }

  /* Utilities */
  .hidden {
    display: none !important;
  }

  .overflow-hidden {
    overflow: hidden;
  }

  @media screen and (min-width: 768px) {
    .md\:hidden {
      display: none !important;
    }

    .md\:flex {
      display: flex !important;
    }
  }
{% endstylesheet %}

{% schema %}
{
  "name": "Header",
  "class": "header-section",
  "settings": [
    {
      "type": "link_list",
      "id": "menu",
      "label": "Menu",
      "default": "main-menu"
    },
    {
      "type": "checkbox",
      "id": "enable_sticky",
      "label": "Enable sticky header",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "enable_transparent",
      "label": "Enable transparent header on homepage",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_search",
      "label": "Show search icon",
      "default": true
    },
    {
      "type": "range",
      "id": "padding",
      "label": "Padding",
      "min": 12,
      "max": 40,
      "step": 2,
      "unit": "px",
      "default": 24
    }
  ],
  "enabled_on": {
    "groups": ["header"]
  }
}
{% endschema %}

