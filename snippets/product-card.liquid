{%- doc -%}
  Renders a product card with image, title, price, and add-to-cart button.
  
  @param {object} product - The product object (required)
  @param {string} [class] - Additional CSS classes for the card
  @param {boolean} [show_add_to_cart] - Whether to show add to cart button (default: true)
  @param {string} [image_sizes] - Responsive image sizes attribute
  @param {number} [image_width] - Max image width for srcset (default: 600)
  @param {boolean} [lazy_load] - Whether to lazy load images (default: true)
  @param {object} [block] - Optional block for shopify_attributes
{%- enddoc -%}

{%- liquid
  assign show_add_to_cart = show_add_to_cart | default: true
  assign image_width = image_width | default: 600
  assign lazy_load = lazy_load | default: true
  assign image_sizes = image_sizes | default: '(max-width: 749px) 50vw, 25vw'
  
  assign first_variant = product.selected_or_first_available_variant
  assign product_image = product.featured_media | default: product.featured_image
-%}

<div class="product-card {{ class }}" {% if block %}{{ block.shopify_attributes }}{% endif %}>
  <a href="{{ product.url }}" class="product-card__link" aria-label="{{ product.title }}">
    <div class="product-card__media">
      {%- if product_image -%}
        <img
          src="{{ product_image | image_url: width: image_width }}"
          srcset="
            {{ product_image | image_url: width: 300 }} 300w,
            {{ product_image | image_url: width: 450 }} 450w,
            {{ product_image | image_url: width: image_width }} {{ image_width }}w
          "
          sizes="{{ image_sizes }}"
          alt="{{ product_image.alt | default: product.title | escape }}"
          width="{{ product_image.width }}"
          height="{{ product_image.height }}"
          class="product-card__image"
          {% if lazy_load %}loading="lazy"{% endif %}
        >
      {%- else -%}
        {{ 'product-1' | placeholder_svg_tag: 'product-card__placeholder' }}
      {%- endif -%}
    </div>
    <div class="product-card__info">
      <h3 class="product-card__title">{{ product.title }}</h3>
      <p class="product-card__price">
        {%- if product.compare_at_price > product.price -%}
          <span class="product-card__price--compare">{{ product.compare_at_price | money }}</span>
        {%- endif -%}
        <span class="product-card__price--current">{{ product.price | money }}</span>
      </p>
    </div>
  </a>
  
  {%- if show_add_to_cart -%}
    <button
      type="button"
      class="product-card__add-to-cart"
      data-variant-id="{{ first_variant.id }}"
      data-product-image="{{ product_image | image_url: width: 100 }}"
      data-product-title="{{ product.title | escape }}"
      {% unless first_variant.available %}disabled{% endunless %}
    >
      {%- if first_variant.available -%}
        <span class="product-card__add-to-cart-text" data-default-text>
          {{ 'products.product.add_to_cart' | t | default: 'ADD TO CART' | upcase }}
        </span>
        <span class="product-card__add-to-cart-text product-card__add-to-cart-text--adding" data-adding-text>
          {{ 'products.product.adding_to_cart' | t | default: 'ADDING...' | upcase }}
        </span>
        <span class="product-card__add-to-cart-text product-card__add-to-cart-text--added" data-added-text>
          {{ 'products.product.added_to_cart' | t | default: 'ADDED!' | upcase }}
        </span>
      {%- else -%}
        {{ 'products.product.sold_out' | t | default: 'SOLD OUT' | upcase }}
      {%- endif -%}
    </button>
  {%- endif -%}
</div>
