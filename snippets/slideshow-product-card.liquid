{%- comment -%}
  Slideshow Product Card Snippet
  
  Renders product information for use in slideshow sections
  
  @param product {Product} - The product object to display
  @param show_vendor {Boolean} - Whether to show vendor name
{%- endcomment -%}

{%- liquid
  assign product = product
  assign show_vendor = show_vendor | default: false
  
  if product == blank
    assign product_available = false
  else
    assign product_available = true
    assign has_variants = false
    if product.variants.size > 1
      assign has_variants = true
    endif
  endif
-%}

{%- if product_available -%}
  <div class="slideshow-product">
    <h3 class="slideshow-product__title">{{ product.title }}</h3>
    
    {%- if show_vendor and product.vendor != blank -%}
      <p class="slideshow-product__vendor">{{ product.vendor }}</p>
    {%- endif -%}
    
    {%- if product.description != blank -%}
      <div class="slideshow-product__description">
        {{ product.description | strip_html }}
      </div>
    {%- endif -%}
    
    {%- comment -%} Variant selector OR Price based on product variants {%- endcomment -%}
    {%- if has_variants -%}
      {%- comment -%} Has variants: show dropdown and add to cart {%- endcomment -%}
      <form 
        class="slideshow-product__form" 
        data-product-form
        data-product-image="{{ product.featured_image | image_url: width: 300 }}"
        data-product-title="{{ product.title | escape }}"
      >
        <div class="slideshow-product__variant-selector">
          <select 
            name="id" 
            class="slideshow-product__select"
            data-variant-select
          >
            {%- for variant in product.variants -%}
              <option 
                value="{{ variant.id }}" 
                {% unless variant.available %}disabled{% endunless %}
                data-price="{{ variant.price }}"
              >
                {{ variant.title }} - {{ variant.price | money }} {{ shop.currency }}{% unless variant.available %} (Sold out){% endunless %}
              </option>
            {%- endfor -%}
          </select>
        </div>
        
        <button 
          type="submit" 
          class="slideshow-product__add-to-cart"
          data-add-to-cart
        >
          Add to Cart
        </button>
      </form>
    {%- else -%}
      {%- comment -%} No variants: show price and add to cart {%- endcomment -%}
      <div class="slideshow-product__price-info">
        <p class="slideshow-product__price">
          {%- if product.compare_at_price > product.price -%}
            <span class="slideshow-product__price-compare">{{ product.compare_at_price | money }} {{ shop.currency }}</span>
          {%- endif -%}
          <span class="slideshow-product__price-amount">{{ product.price | money }} {{ shop.currency }}</span>
        </p>
      </div>
      
      <form 
        class="slideshow-product__form" 
        data-product-form
        data-product-image="{{ product.featured_image | image_url: width: 300 }}"
        data-product-title="{{ product.title | escape }}"
      >
        <input type="hidden" name="id" value="{{ product.variants.first.id }}">
        <button 
          type="submit" 
          class="slideshow-product__add-to-cart"
          data-add-to-cart
          {% unless product.available %}disabled{% endunless %}
        >
          {% if product.available %}Add to Cart{% else %}Sold Out{% endif %}
        </button>
      </form>
    {%- endif -%}
  </div>
{%- else -%}
  <div class="slideshow-product slideshow-product--empty">
    <p class="slideshow-product__empty-message">Select a product to display</p>
  </div>
{%- endif -%}

{% stylesheet %}
  .slideshow-product {
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
    min-height: 200px;
  }
  
  @media screen and (min-width: 1024px) {
    .slideshow-product {
      min-height: 250px;
    }
  }
  
  .slideshow-product__title {
    font-family: var(--font-heading-family);
    font-size: var(--section-heading-sm, 1.5rem);
    font-weight: var(--font-heading-weight, 400);
    line-height: 1.2;
    margin: 0;
    color: var(--color-foreground);
  }
  
  @media screen and (min-width: 1024px) {
    .slideshow-product__title {
      font-size: var(--section-heading-sm-desktop, 1.875rem);
    }
  }
  
  .slideshow-product__vendor {
    font-family: var(--font-body-family);
    font-size: 0.875rem;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    color: var(--color-foreground);
    opacity: 0.6;
    margin: 0;
  }
  
  .slideshow-product__description {
    font-family: var(--font-body-family);
    font-size: 0.9375rem;
    line-height: 1.7;
    color: var(--color-foreground);
    opacity: 0.7;
    display: -webkit-box;
    -webkit-line-clamp: 3;
    -webkit-box-orient: vertical;
    overflow: hidden;
    text-overflow: ellipsis;
    max-width: 500px;
  }
  
  .slideshow-product__price-info {
    margin-top: 0.5rem;
  }
  
  .slideshow-product__price {
    font-family: var(--font-heading-family);
    font-size: 1rem;
    font-weight: 500;
    margin: 0 0 1rem;
    color: var(--color-foreground);
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }
  
  .slideshow-product__price-separator {
    opacity: 0.5;
    margin: 0 0.25rem;
  }
  
  .slideshow-product__price-compare {
    font-size: 1rem;
    text-decoration: line-through;
    opacity: 0.5;
  }
  
  .slideshow-product__form {
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
    margin-top: 1rem;
  }
  
  .slideshow-product__variant-selector {
    width: 100%;
  }
  
  .slideshow-product__select {
    width: 100%;
    padding: 0.75rem 1rem;
    font-family: var(--font-body-family);
    font-size: 0.9375rem;
    color: var(--color-foreground);
    background-color: var(--color-background, #fff);
    border: 1px solid var(--color-border, rgba(0, 0, 0, 0.2));
    border-radius: 4px;
    cursor: pointer;
    transition: border-color 0.3s ease;
  }
  
  .slideshow-product__select:hover {
    border-color: var(--color-foreground);
  }
  
  .slideshow-product__select:focus {
    outline: none;
    border-color: var(--color-foreground);
  }
  
  .slideshow-product__select option:disabled {
    color: rgba(0, 0, 0, 0.3);
  }
  
  .slideshow-product__add-to-cart {
    width: 100%;
    padding: 0.875rem 1.5rem;
    font-family: var(--font-body-family);
    font-size: 0.8rem;
    letter-spacing: 0.05em;
    font-weight: 500;
    color: var(--color-button-text, #fff);
    background-color: var(--color-button, #000);
    border: none;
    border-radius: 4px;
    cursor: pointer;
    text-transform: uppercase;
    transition: opacity 0.3s ease, transform 0.2s ease;
  }
  
  .slideshow-product__add-to-cart:hover:not(:disabled) {
    opacity: 0.9;
    transform: translateY(-1px);
  }
  
  .slideshow-product__add-to-cart:active:not(:disabled) {
    transform: translateY(0);
  }
  
  .slideshow-product__add-to-cart:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }

  .slideshow-product--empty {
    padding: 2rem;
    text-align: center;
    opacity: 0.5;
  }
  
  .slideshow-product__empty-message {
    font-family: var(--font-body-family);
    font-size: 0.9375rem;
    margin: 0;
  }
{% endstylesheet %}

{%- comment -%}
  Add-to-cart functionality is handled globally by global.js
  The form with [data-product-form] attribute will be automatically handled
{%- endcomment -%}
